<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido a USDExchangE</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <style>
      body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
    background-color: #222;
    color: #fff;
    font-family: Arial, sans-serif;
}

.container {
    text-align: center;
}

.titulo {
    font-size: 32px;
    margin-bottom: 30px;
    letter-spacing: 2px;
}

.boton {
    padding: 12px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    border-radius: 30px;
    font-size: 16px;
    background-color: #ff6600;
    color: #222;
    text-transform: uppercase;
    transition: all 0.3s ease;
    box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.3);
    position: relative;

}

.boton:hover {
    background-color: #ff9900;
}
.estado-indicador {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    opacity: 0; /* Comienza como invisible */
    animation: titilar 1s infinite alternate; /* Aplica la animación */
}

.activo .estado-indicador {
    background-color: #00cc00; /* Color verde cuando está activo */
}

.inactivo .estado-indicador {
    background-color: #ff3333; /* Color rojo cuando está inactivo */
}

@keyframes titilar {
    0% {
        opacity: 0; /* Invisible al inicio de la animación */
    }
    100% {
        opacity: 1; /* Visible al final de la animación */
    }
}
.oculto {
    display: none;
}

.activo {
    background-color: #00cc00;
    color: #fff;
}

.inactivo {
    background-color: #ff3333;
    color: #fff;
}

.saldo-container {
    margin-top: 20px;
    font-size: 20px;
    letter-spacing: 1px;
}

.saldo {
    margin-bottom: 10px;
}

span {
    color: #ffcc00;
}
        .mensaje-error {
    color: #ff3333; /* Color rojo para el mensaje de error */
    margin-top: 10px;
}



    </style>
</head>

<body>
    <div class="container">
        <div class="titulo">Bienvenido a USDExchangE</div>
        <button class="boton" id="web3Button" onclick="conectarMetaMask()">Web3 Inactivo  <span class="estado-indicador" id="activoIndicador"></span></button>
        <div id="direccion" class="oculto"></div>
        <div id="saldoETH" class="oculto"></div>

       <div class="saldo-container oculto" id="saldoContainerUSD">
    <div class="saldo">Saldo USD: <span id="saldoUSDValor">0</span> USD</div>
    <input type="number" id="depositarUSDMonto" placeholder="Ingrese cantidad USD">
    <button class="boton" id="depositarUSD" onclick="depositar('USD')">Depositar USD</button>
</div>

<div class="saldo-container oculto" id="saldoContainerUSDT">
    <div class="saldo">Saldo USDT: <span id="saldoUSDTValor">0</span> USDT</div>
    <input type="number" id="comprarUSDTMonto" placeholder="Ingrese cantidad USDT">
    <button class="boton" id="comprarUSDT" onclick="comprar('USDT')">Comprar USDT</button>
    <div id="mensajeError" class="mensaje-error oculto"></div>
</div>

    </div>

    <script>
        async function conectarMetaMask() {
            const web3Button = document.getElementById('web3Button');

            if (typeof window.ethereum !== 'undefined') {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const userAddress = accounts[0];

                document.getElementById('direccion').innerText = `Dirección: ${userAddress}`;
                document.getElementById('direccion').classList.remove('oculto');

                const web3 = new Web3(window.ethereum);

                const ethBalance = await web3.eth.getBalance(userAddress);
                const formattedEthBalance = web3.utils.fromWei(ethBalance, 'ether');
                document.getElementById('saldoETH').innerText = `Saldo ETH: ${formattedEthBalance} ETH`;
                document.getElementById('saldoETH').classList.remove('oculto');

                // Saldo ficticio de USDT y USD
                const usdtBalance = 0;
                const usdBalance = 0;

                // Actualizar los valores de los saldos en el HTML
                document.getElementById('saldoUSDTValor').innerText = usdtBalance;
                document.getElementById('saldoUSDValor').innerText = usdBalance;

                // Mostrar contenedores de saldos y botones después de la conexión
                document.getElementById('saldoContainerUSD').classList.remove('oculto');
                document.getElementById('saldoContainerUSDT').classList.remove('oculto');

                const depositarUSDMonto = document.getElementById('depositarUSDMonto').value;
                const comprarUSDTMonto = document.getElementById('comprarUSDTMonto').value;


                // Cambiar el texto y color del botón
                web3Button.innerText = 'Web3 Activo';
                web3Button.classList.add('activo');
                web3Button.classList.remove('inactivo');
                
            } else {
                // Cambiar el texto y color del botón
                web3Button.innerText = 'Web3 Inactivo';
                web3Button.classList.add('inactivo');
                web3Button.classList.remove('activo');

                alert('MetaMask no está instalado. Por favor, instálalo para continuar.');
            }
        }
       async function comprar(tipo) {
    const saldoUSD = parseFloat(document.getElementById('saldoUSDValor').textContent);
    const comprarUSDTMonto = parseFloat(document.getElementById('comprarUSDTMonto').value);
    const mensajeError = document.getElementById('mensajeError');

    if (saldoUSD >= comprarUSDTMonto) {
        // Aquí colocas la lógica para realizar la compra de USDT
        // Por ejemplo, podrías deducir el monto de USDT del saldo USDT y actualizar el saldo USD.

        // Mostrar mensaje de éxito
        alert('Compra de USDT realizada con éxito.');
        mensajeError.classList.add('oculto'); // Oculta el mensaje de error si estaba visible
    } else {
        // Mostrar mensaje de error si no hay suficiente saldo USD
        mensajeError.innerText = 'SALDO USD INSUFICIENTE. Deposita USD para comprar USDT.';
        mensajeError.classList.remove('oculto'); // Muestra el mensaje de error
    }
}


    </script>
</body>

</html>
